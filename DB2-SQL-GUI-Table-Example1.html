<!DOCTYPE html>
<!--
        Mainframe Cloud Pty Ltd MainSpace Example App - MainSpace User Guide Example #6.
        For more information refer to Mainframe Cloud Resources www.mainframecloud.com and download the MainSpace Guide.
-->
<html>
    <head>
        <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
        <!-- IMPORT THIRD PARTY GUI CSS LIBS.                                -->
        <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
        <link href="https://www.mainframecloudplatform.com/applibs/fgrid/fancy.min.css" rel="stylesheet">
    </head>
    <body>
        <h2>MainSpace: DB2 SQL Example - Third Party GUI Table Display</h2>
        <div id="container"></div>

        <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
        <!-- Load MainSpace API JS LIB.                                      -->
        <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
        <script type="text/javascript" src="https://www.mainframecloudplatform.com/applibs/mainspace-platform.js"></script>
        <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
        <!-- IMPORT THIRD PARTY GUI LIBS.                                    -->
        <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
        <script type="text/javascript" src="https://www.mainframecloudplatform.com/applibs/fgrid/fancy.full.min.js"></script>
        <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
        <!-- JavaScript Code Section                                         -->
        <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
        <script>
            /*
             * MainSpace API call.
             * Perform an SQL query and call nominated user function when SQL query complete.
             */
            var obj1 = MFCAgentRequest.newObject();
            var json_inputargs = {
                "db2ssid":"DBBG",
                "callbackFunction":"callBack( thisObject.response );",
                "sql":[ "SELECT * FROM DSN81110.EMP"
                      ]
            }
            obj1.runSQL( json_inputargs );

            /*
             * User callback function.
             * Display table (third party GUI) from JSON response data.
             */
            function callBack( response ) {
                // Create column headings object with extracts from response data.
                var headings = [];
                for ( headI = 0 ; headI < response.sqlresp.resultset[0].column.length ; headI++ ) {
                    headings.push( { index: response.sqlresp.resultset[0].column[headI].title,
                                     title: response.sqlresp.resultset[0].column[headI].title } );
                }
                /*
                 * Call third party GUI library to display table with the JSON data.
                 */
                new FancyGrid({
                    renderTo: 'container',
                    width: 'fit',
                    height: 400,
                    data: response.sqlresp.resultset[0].row,
                    columns: headings
                });
            }

        </script>
    </body>
</html>
